---
export const prerender = true;
import { getCollection } from "astro:content";
import BaseLayout from "../layouts/BaseLayout.astro";
import PlaceCard from "../components/PlaceCard.astro";

const allPlaces = await getCollection("places");
const states = [...new Set(allPlaces.map((p) => p.data.location.state))].sort();

/* Top-rated places for the hero featured section */
const featured = allPlaces
  .filter((p) => p.data.ratings.google_rating !== null)
  .sort((a, b) => (b.data.ratings.google_rating ?? 0) - (a.data.ratings.google_rating ?? 0))
  .slice(0, 6);
---

<BaseLayout title="Northeast Explorer — Discover Northeast India">

  {/* ═══ Hero Section — Whitespace is Luxury (py-24) ═══════════ */}
  <section class="bg-white py-24">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="max-w-3xl">
        <p class="text-sm font-semibold uppercase tracking-widest text-emerald-600">
          Discover Northeast India
        </p>
        <h1 class="mt-3 text-5xl font-bold tracking-tight text-gray-900 sm:text-6xl">
          Untouched beauty,<br />
          unforgettable journeys.
        </h1>
        <p class="mt-6 text-xl leading-relaxed text-gray-500">
          {allPlaces.length} handpicked destinations across {states.length} states.
          Waterfalls, living root bridges, sacred monasteries, and misty peaks — all waiting for you.
        </p>
        <div class="mt-10 flex flex-wrap gap-4">
          <a
            href="/plan"
            class="inline-flex items-center rounded-full bg-emerald-600 px-8 py-3.5 text-sm font-semibold text-white shadow-sm transition hover:bg-emerald-700"
          >
            Plan Your Trip
          </a>
          <a
            href="/map"
            class="inline-flex items-center rounded-full border border-gray-200 bg-white px-8 py-3.5 text-sm font-semibold text-gray-700 shadow-sm transition hover:bg-gray-50"
          >
            Explore Map
          </a>
        </div>
      </div>
    </div>
  </section>

  {/* ═══ Browse by State — Generous section spacing ════════════ */}
  <section class="bg-gray-50 py-16">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl font-bold text-gray-900">Browse by State</h2>
      <p class="mt-2 text-gray-500">Explore destinations across Northeast India's eight sister states.</p>

      <div class="mt-8 flex flex-wrap gap-3">
        {states.map((state) => {
          const count = allPlaces.filter((p) => p.data.location.state === state).length;
          return (
            <a
              href={`/states/${state.toLowerCase().replace(/\s+/g, "-")}`}
              class="inline-flex items-center gap-2 rounded-full border border-gray-200 bg-white px-5 py-2.5 text-sm font-medium text-gray-700 shadow-sm transition hover:border-emerald-200 hover:bg-emerald-50 hover:text-emerald-700"
            >
              {state}
              <span class="rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-500">
                {count}
              </span>
            </a>
          );
        })}
      </div>
    </div>
  </section>

  {/* ═══ Featured Destinations — Top rated ═════════════════════ */}
  <section class="bg-white py-24">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="flex items-end justify-between">
        <div>
          <h2 class="text-2xl font-bold text-gray-900">Top Rated Destinations</h2>
          <p class="mt-2 text-gray-500">Highest-rated places by travelers on Google.</p>
        </div>
        <a href="/states" class="hidden text-sm font-semibold text-emerald-600 hover:text-emerald-700 sm:block">
          View all &rarr;
        </a>
      </div>

      <div class="mt-10 grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
        {featured.map((place) => (
          <PlaceCard
            id={place.data.id}
            name={place.data.name}
            category={place.data.category}
            subCategory={place.data.sub_category}
            state={place.data.location.state}
            googleRating={place.data.ratings.google_rating}
            reviewsCount={place.data.ratings.google_reviews_count}
            tags={place.data.tags}
            image={place.data.images[0]}
            logistics={place.data.logistics}
          />
        ))}
      </div>

      <div class="mt-8 text-center sm:hidden">
        <a href="/states" class="text-sm font-semibold text-emerald-600 hover:text-emerald-700">
          View all destinations &rarr;
        </a>
      </div>
    </div>
  </section>

  {/* ═══ All Destinations ══════════════════════════════════════ */}
  <section class="bg-gray-50 py-24">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <h2 class="text-2xl font-bold text-gray-900">All {allPlaces.length} Destinations</h2>
      <p class="mt-2 mb-10 text-gray-500">Every place worth visiting in Northeast India.</p>

      <div class="grid gap-8 sm:grid-cols-2 lg:grid-cols-3">
        {allPlaces.map((place) => (
          <PlaceCard
            id={place.data.id}
            name={place.data.name}
            category={place.data.category}
            subCategory={place.data.sub_category}
            state={place.data.location.state}
            googleRating={place.data.ratings.google_rating}
            reviewsCount={place.data.ratings.google_reviews_count}
            tags={place.data.tags}
            image={place.data.images[0]}
            logistics={place.data.logistics}
          />
        ))}
      </div>
    </div>
  </section>

</BaseLayout>
