---
import { getCollection } from "astro:content";
import BaseLayout from "../../layouts/BaseLayout.astro";

const allPlaces = await getCollection("places");

const stateMap = new Map<string, number>();
for (const place of allPlaces) {
  const state = place.data.location.state;
  stateMap.set(state, (stateMap.get(state) || 0) + 1);
}
const states = [...stateMap.entries()].sort((a, b) => a[0].localeCompare(b[0]));
---

<BaseLayout title="Browse by State â€” Northeast Explorer">
  <div class="mx-auto max-w-7xl px-4 py-10 sm:px-6 lg:px-8">
    <h1 class="mb-8 text-3xl font-bold tracking-tight text-gray-900">Browse by State</h1>
    <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-4">
      {states.map(([state, count]) => (
        <a
          href={`/states/${state.toLowerCase().replace(/\s+/g, "-")}`}
          class="group rounded-xl border border-gray-200 bg-white p-6 shadow-sm transition hover:shadow-md"
        >
          <h2 class="text-xl font-semibold text-gray-900 group-hover:text-emerald-700">
            {state}
          </h2>
          <p class="mt-1 text-sm text-gray-500">{count} destinations</p>
        </a>
      ))}
    </div>
  </div>
</BaseLayout>
